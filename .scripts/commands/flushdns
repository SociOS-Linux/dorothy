#!/usr/bin/env bash

echo 'flushing...'

if command_exists dnscrypt-proxy; then
	echo 'dnscrypt-proxy'
	brew services restart dnscrypt-proxy
fi

# https://support.apple.com/en-us/HT202516
if is_mac; then
	if command_exists mDNSResponder; then
		echo 'mDNSResponder'
		sudo killall -HUP mDNSResponder
	fi
	if command_exists dscacheutil; then
		echo 'dscacheutil'
		sudo dscacheutil -flushcache
	fi
	if command_exists discoveryutil; then
		echo 'discoveryutil'
		sudo discoveryutil mdnsflushcache
	fi
else
	echo "DNS flushing only for MacOS currently"
fi