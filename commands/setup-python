#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# Uninstall Python
if is-brew; then
	echo -e '\nRemoving old brew python installations...'
	ok brew uninstall --ignore-dependencies python
	rm -rf "/Users/$(whoami)/Library/Python/"*
	rm -rf "$(brew --cellar)/python"*
	rm -rf "$(brew --prefix)/opt/python"*

	echo -e '\nInstalling latest brew python...'
	brew install python
fi

# Helper
function pipinstall {
	for ARG in "$@"; do
		pip-install "$ARG"
	done
}

# Reload Paths
echo -e '\nReload paths and install latest pip tooling...'
source "$DOROTHY/sources/essentials.sh"
echo "python3=$(which python3)"
echo "pip3=$(which pip3)"
echo "pip=$(which pip)"
pipinstall pip setuptools

# Reload Paths
	echo -e '\nReload paths for latest pip tooling...'
source "$DOROTHY/sources/essentials.sh"
echo "python3=$(which python3)"
echo "pip3=$(which pip3)"
echo "pip=$(which pip)"

# Install
if is-present "${PYTHON_INSTALL-}"; then
	echo -e '\nInstalling pip packages...'
	pipinstall "${PYTHON_INSTALL[@]}"
fi
