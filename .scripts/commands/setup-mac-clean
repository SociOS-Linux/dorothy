#!/usr/bin/env bash
source "$HOME/.scripts/sources/essentials.sh"
set -e

echo -e '\nCleaning MacOS post-update garbage...'

# Clean brew
brew cleanup
brew cask cleanup
brew prune

# Remove updates that are not cleaned automatically
rm -Rf "$HOME/Library/Application Support/Plex Media Server/Updates"
rm -Rf "$HOME/Library/Application Support/Spotify/PersistentCache/Update"

# Remove cache
rm -Rf "$HOME/.cache"
mkdir -p "$HOME/Library/Caches"
mkdir -p "$HOME/.cache/gems"
mkdir -p "$HOME/.cache/pip/http"
mkdir -p "$HOME/Library/Caches/pip/http"

# npm
if command-exists npm; then
	silent nvm use node
	silent npm cache clean --force
	silent nvm use system
	silent npm cache clean --force
fi

echo '...clean successful!'